{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vcarrera/Desktop/chinawok-frontend/lib/chinaWokApi.ts"],"sourcesContent":["import { fetchAuthSession } from \"aws-amplify/auth\";\n\n// URL base de tu API Gateway\nconst API_BASE_URL = \"https://tjutjvm10b.execute-api.us-east-1.amazonaws.com\";\n\n// --- Tipos de Datos ---\n// Define las estructuras de datos para mayor claridad y seguridad de tipos.\n\ninterface Address {\n  name: string;\n  address: string;\n}\n\ninterface UserProfile {\n  userId: string;\n  name: string;\n  addresses: Address[];\n}\n\ninterface OrderItem {\n  productId: string;\n  quantity: number;\n  price: number;\n}\n\ninterface OrderData {\n  tenantId: string;\n  items: OrderItem[];\n  total: number;\n  customer: {\n    userId: string;\n    name: string;\n    address: string;\n  };\n}\n\n// --- Helper para Autenticación ---\n\n/**\n * Obtiene el token de autenticación (JWT) de la sesión del usuario actual.\n * Lanza un error si el usuario no está autenticado.\n * @returns {Promise<string>} El token de ID del usuario.\n */\nasync function getAuthToken(): Promise<string> {\n  try {\n    const session = await fetchAuthSession();\n    const token = session.tokens?.idToken?.toString();\n    if (!token) {\n      throw new Error(\"No se encontró el token de autenticación.\");\n    }\n    return token;\n  } catch (error) {\n    console.error(\"Error al obtener la sesión de autenticación:\", error);\n    throw new Error(\"Usuario no autenticado.\");\n  }\n}\n\n// --- Funciones de la API ---\n\n/**\n * Obtiene el perfil de un usuario, incluyendo sus direcciones guardadas.\n * @param {string} userId - El ID del usuario (usualmente `user.username` de Amplify).\n * @returns {Promise<UserProfile>} El perfil del usuario.\n */\nexport async function getProfile(userId: string): Promise<UserProfile> {\n  const token = await getAuthToken();\n  const response = await fetch(`${API_BASE_URL}/profile?userId=${userId}`, {\n    method: \"GET\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: `Bearer ${token}`,\n    },\n  });\n\n  if (!response.ok) {\n    const errorData = await response.json();\n    throw new Error(errorData.message || \"Error al obtener el perfil.\");\n  }\n  return response.json();\n}\n\n/**\n * Guarda una nueva dirección para un usuario.\n * @param {string} userId - El ID del usuario.\n * @param {string} address - La dirección a guardar.\n * @param {string} name - Un nombre o alias para la dirección (ej: \"Casa\", \"Oficina\").\n * @returns {Promise<any>} La respuesta del servidor.\n */\nexport async function saveAddress(userId: string, address: string, name: string): Promise<any> {\n  const token = await getAuthToken();\n  const response = await fetch(`${API_BASE_URL}/profile`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: `Bearer ${token}`,\n    },\n    body: JSON.stringify({ userId, address, name }),\n  });\n\n  if (!response.ok) {\n    const errorData = await response.json();\n    throw new Error(errorData.message || \"Error al guardar la dirección.\");\n  }\n  return response.json();\n}\n\n/**\n * Crea un nuevo pedido, asociándolo a un cliente autenticado.\n * @param {OrderData} orderData - El objeto completo del pedido.\n * @returns {Promise<any>} La respuesta del servidor, incluyendo el `orderId`.\n */\nexport async function createOrder(orderData: OrderData): Promise<any> {\n  const token = await getAuthToken();\n  const response = await fetch(`${API_BASE_URL}/order`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: `Bearer ${token}`,\n    },\n    body: JSON.stringify(orderData),\n  });\n\n  if (!response.ok) {\n    const errorData = await response.json();\n    throw new Error(errorData.message || \"Error al crear el pedido.\");\n  }\n  return response.json();\n}\n\n/**\n * Obtiene todos los pedidos para un usuario específico.\n * @param {string} userId - El ID del usuario.\n * @returns {Promise<any[]>} Una lista de los pedidos del usuario.\n */\nexport async function getMyOrders(userId: string): Promise<any[]> {\n    const token = await getAuthToken();\n    const response = await fetch(`${API_BASE_URL}/orders?userId=${userId}`, {\n        method: 'GET',\n        headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${token}`,\n        },\n    });\n\n    if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.message || 'Error al obtener los pedidos.');\n    }\n    return response.json();\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAEA,6BAA6B;AAC7B,MAAM,eAAe;AAiCrB,oCAAoC;AAEpC;;;;CAIC,GACD,eAAe;IACb,IAAI;QACF,MAAM,UAAU,MAAM,IAAA,qNAAgB;QACtC,MAAM,QAAQ,QAAQ,MAAM,EAAE,SAAS;QACvC,IAAI,CAAC,OAAO;YACV,MAAM,IAAI,MAAM;QAClB;QACA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gDAAgD;QAC9D,MAAM,IAAI,MAAM;IAClB;AACF;AASO,eAAe,WAAW,MAAc;IAC7C,MAAM,QAAQ,MAAM;IACpB,MAAM,WAAW,MAAM,MAAM,GAAG,aAAa,gBAAgB,EAAE,QAAQ,EAAE;QACvE,QAAQ;QACR,SAAS;YACP,gBAAgB;YAChB,eAAe,CAAC,OAAO,EAAE,OAAO;QAClC;IACF;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,YAAY,MAAM,SAAS,IAAI;QACrC,MAAM,IAAI,MAAM,UAAU,OAAO,IAAI;IACvC;IACA,OAAO,SAAS,IAAI;AACtB;AASO,eAAe,YAAY,MAAc,EAAE,OAAe,EAAE,IAAY;IAC7E,MAAM,QAAQ,MAAM;IACpB,MAAM,WAAW,MAAM,MAAM,GAAG,aAAa,QAAQ,CAAC,EAAE;QACtD,QAAQ;QACR,SAAS;YACP,gBAAgB;YAChB,eAAe,CAAC,OAAO,EAAE,OAAO;QAClC;QACA,MAAM,KAAK,SAAS,CAAC;YAAE;YAAQ;YAAS;QAAK;IAC/C;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,YAAY,MAAM,SAAS,IAAI;QACrC,MAAM,IAAI,MAAM,UAAU,OAAO,IAAI;IACvC;IACA,OAAO,SAAS,IAAI;AACtB;AAOO,eAAe,YAAY,SAAoB;IACpD,MAAM,QAAQ,MAAM;IACpB,MAAM,WAAW,MAAM,MAAM,GAAG,aAAa,MAAM,CAAC,EAAE;QACpD,QAAQ;QACR,SAAS;YACP,gBAAgB;YAChB,eAAe,CAAC,OAAO,EAAE,OAAO;QAClC;QACA,MAAM,KAAK,SAAS,CAAC;IACvB;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,YAAY,MAAM,SAAS,IAAI;QACrC,MAAM,IAAI,MAAM,UAAU,OAAO,IAAI;IACvC;IACA,OAAO,SAAS,IAAI;AACtB;AAOO,eAAe,YAAY,MAAc;IAC5C,MAAM,QAAQ,MAAM;IACpB,MAAM,WAAW,MAAM,MAAM,GAAG,aAAa,eAAe,EAAE,QAAQ,EAAE;QACpE,QAAQ;QACR,SAAS;YACL,gBAAgB;YAChB,iBAAiB,CAAC,OAAO,EAAE,OAAO;QACtC;IACJ;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QACd,MAAM,YAAY,MAAM,SAAS,IAAI;QACrC,MAAM,IAAI,MAAM,UAAU,OAAO,IAAI;IACzC;IACA,OAAO,SAAS,IAAI;AACxB"}},
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vcarrera/Desktop/chinawok-frontend/lib/services/orders-service.ts"],"sourcesContent":["// Definición de tipos para una mayor claridad y seguridad\ninterface OrderItem {\n  // Define la estructura de un item en el pedido, por ejemplo:\n  productId: string;\n  quantity: number;\n  price: number;\n}\n\ninterface CreateOrderPayload {\n  tenantId: string;\n  items: OrderItem[];\n  total: number;\n}\n\ninterface CreateOrderResponse {\n  orderId: string;\n  message: string;\n}\n\ninterface OrderStatus {\n  orderId: string;\n  status: 'EN_COCINA' | 'EMPACADO' | 'EN_CAMINO' | 'ENTREGADO' | 'CANCELADO';\n  // ... otras propiedades que pueda tener el objeto de estado del pedido\n}\n\nconst API_BASE_URL = 'https://tjutjvm10b.execute-api.us-east-1.amazonaws.com';\n\n/**\n * Crea un nuevo pedido enviando los datos al API Gateway.\n * @param {OrderItem[]} items - Array de productos en el pedido.\n * @param {number} total - El monto total del pedido.\n * @returns {Promise<CreateOrderResponse>} - La respuesta de la API con el ID del pedido.\n */\nexport const createOrder = async (items: OrderItem[], total: number): Promise<CreateOrderResponse> => {\n  const payload: CreateOrderPayload = {\n    tenantId: 'sede-central', // Tal como se requiere en el body\n    items,\n    total,\n  };\n\n  try {\n    const response = await fetch(`${API_BASE_URL}/order`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(payload),\n    });\n\n    if (!response.ok) {\n      // Si la respuesta no es 2xx, lanza un error que será capturado por el bloque catch.\n      const errorData = await response.json();\n      throw new Error(errorData.message || 'Error al crear el pedido.');\n    }\n\n    return await response.json();\n  } catch (error) {\n    console.error('Error en createOrder:', error);\n    // Re-lanza el error para que el componente que llama pueda manejarlo.\n    throw error;\n  }\n};\n\n/**\n * Obtiene la lista de todos los pedidos y sus estados.\n * @returns {Promise<OrderStatus[]>} - Un array con los estados de los pedidos.\n */\nexport const getOrders = async (): Promise<OrderStatus[]> => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/orders`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json();\n      throw new Error(errorData.message || 'Error al obtener los pedidos.');\n    }\n\n    return await response.json();\n  } catch (error) {\n    console.error('Error en getOrders:', error);\n    throw error;\n  }\n};"],"names":[],"mappings":"AAAA,0DAA0D;;;;;;;AAyB1D,MAAM,eAAe;AAQd,MAAM,cAAc,OAAO,OAAoB;IACpD,MAAM,UAA8B;QAClC,UAAU;QACV;QACA;IACF;IAEA,IAAI;QACF,MAAM,WAAW,MAAM,MAAM,GAAG,aAAa,MAAM,CAAC,EAAE;YACpD,QAAQ;YACR,SAAS;gBACP,gBAAgB;YAClB;YACA,MAAM,KAAK,SAAS,CAAC;QACvB;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,oFAAoF;YACpF,MAAM,YAAY,MAAM,SAAS,IAAI;YACrC,MAAM,IAAI,MAAM,UAAU,OAAO,IAAI;QACvC;QAEA,OAAO,MAAM,SAAS,IAAI;IAC5B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,sEAAsE;QACtE,MAAM;IACR;AACF;AAMO,MAAM,YAAY;IACvB,IAAI;QACF,MAAM,WAAW,MAAM,MAAM,GAAG,aAAa,OAAO,CAAC,EAAE;YACrD,QAAQ;YACR,SAAS;gBACP,gBAAgB;YAClB;QACF;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,MAAM,YAAY,MAAM,SAAS,IAAI;YACrC,MAAM,IAAI,MAAM,UAAU,OAAO,IAAI;QACvC;QAEA,OAAO,MAAM,SAAS,IAAI;IAC5B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,uBAAuB;QACrC,MAAM;IACR;AACF"}},
    {"offset": {"line": 162, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vcarrera/Desktop/chinawok-frontend/components/ui/card.tsx"],"sourcesContent":["import * as React from 'react'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Card({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card\"\r\n      className={cn(\r\n        'bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardHeader({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-header\"\r\n      className={cn(\r\n        '@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardTitle({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-title\"\r\n      className={cn('leading-none font-semibold', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardDescription({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-description\"\r\n      className={cn('text-muted-foreground text-sm', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardAction({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-action\"\r\n      className={cn(\r\n        'col-start-2 row-span-2 row-start-1 self-start justify-self-end',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardContent({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-content\"\r\n      className={cn('px-6', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardFooter({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-footer\"\r\n      className={cn('flex items-center px-6 [.border-t]:pt-6', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport {\r\n  Card,\r\n  CardHeader,\r\n  CardFooter,\r\n  CardTitle,\r\n  CardAction,\r\n  CardDescription,\r\n  CardContent,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 294, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vcarrera/Desktop/chinawok-frontend/app/checkout/page.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState, useEffect } from \"react\";\nimport { useCart } from \"@/lib/context/cart-context\";\nimport * as chinaWokApi from \"@/lib/chinaWokApi\";\nimport { getOrders } from \"@/lib/services/orders-service\"; // Reutilizamos el servicio de polling\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport {\n  MapPin,\n  User,\n  Loader2,\n  PackageCheck,\n  ShoppingCart,\n  LogOut,\n  PlusCircle,\n} from \"lucide-react\";\nimport Link from \"next/link\";\nimport { Authenticator, useAuthenticator } from \"@aws-amplify/ui-react\";\n\n// Tipos locales\ntype OrderStatus = \"EN_COCINA\" | \"EMPACADO\" | \"EN_CAMINO\" | \"ENTREGADO\" | \"CANCELADO\";\ninterface Address {\n  name: string;\n  address: string;\n}\n\n/**\n * Componente principal de la página de Checkout.\n * Gestiona la autenticación, direcciones y creación de pedidos.\n */\nfunction CheckoutFlow() {\n  const { user, signOut } = useAuthenticator((context) => [context.user]);\n  const { items, total, clearCart } = useCart();\n\n  // Estados del componente\n  const [loading, setLoading] = useState({ profile: true, order: false, address: false });\n  const [error, setError] = useState<string | null>(null);\n\n  // Estados para la gestión de direcciones\n  const [addresses, setAddresses] = useState<Address[]>([]);\n  const [selectedAddress, setSelectedAddress] = useState<string>(\"\");\n  const [showNewAddressForm, setShowNewAddressForm] = useState(false);\n  const [newAddress, setNewAddress] = useState({ name: \"\", address: \"\" });\n\n  // Estados para el seguimiento del pedido\n  const [orderId, setOrderId] = useState<string | null>(null);\n  const [orderStatus, setOrderStatus] = useState<OrderStatus | null>(null);\n\n  // --- EFECTOS ---\n\n  // 1. Cargar perfil del usuario (direcciones)\n  useEffect(() => {\n    if (user?.username) {\n      fetchProfile();\n    }\n  }, [user]);\n\n  // 2. Polling para el estado del pedido (reutilizado de la implementación anterior)\n  useEffect(() => {\n    if (!orderId) return;\n    const intervalId = setInterval(async () => {\n      try {\n        const allOrders = await getOrders();\n        const currentOrder = allOrders.find((o) => o.orderId === orderId);\n        if (currentOrder) {\n          setOrderStatus(currentOrder.status);\n          if ([\"ENTREGADO\", \"CANCELADO\"].includes(currentOrder.status)) {\n            clearInterval(intervalId);\n          }\n        }\n      } catch (err) {\n        console.error(\"Error durante el polling:\", err);\n      }\n    }, 5000);\n    return () => clearInterval(intervalId);\n  }, [orderId]);\n\n  // --- MANEJADORES DE DATOS ---\n\n  const fetchProfile = async () => {\n    if (!user?.username) return;\n    setLoading(prev => ({ ...prev, profile: true }));\n    try {\n      const profile = await chinaWokApi.getProfile(user.username);\n      \n      // Transformar el array de strings de la API a un array de objetos\n      const addressesFromApi = profile.addresses || [];\n      const formattedAddresses = Array.isArray(addressesFromApi)\n        ? addressesFromApi.map((addrStr: string) => ({\n            name: addrStr, // Usar el string de la dirección como nombre\n            address: addrStr, // y como la dirección misma\n          }))\n        : [];\n\n      setAddresses(formattedAddresses);\n      \n      // Si hay direcciones formateadas, selecciona la primera por defecto\n      if (formattedAddresses.length > 0) {\n        setSelectedAddress(formattedAddresses[0].address);\n      }\n\n    } catch (err) {\n      console.warn(\"No se pudo obtener el perfil, puede que sea un usuario nuevo.\", err);\n      setAddresses([]); // Asegurarse de que las direcciones estén vacías si falla\n    } finally {\n      setLoading(prev => ({ ...prev, profile: false }));\n    }\n  };\n\n  const handleSaveAddress = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!user?.username || !newAddress.name || !newAddress.address) {\n      setError(\"El nombre y la dirección son requeridos.\");\n      return;\n    }\n    setLoading(prev => ({ ...prev, address: true }));\n    setError(null);\n    try {\n      await chinaWokApi.saveAddress(user.username, newAddress.address, newAddress.name);\n      setNewAddress({ name: \"\", address: \"\" });\n      setShowNewAddressForm(false);\n      await fetchProfile(); // Recargar direcciones\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"Error al guardar la dirección.\");\n    } finally {\n      setLoading(prev => ({ ...prev, address: false }));\n    }\n  };\n\n  const handleCreateOrder = async () => {\n    if (!user?.username || !selectedAddress) {\n      setError(\"Debes seleccionar una dirección de envío.\");\n      return;\n    }\n    setLoading(prev => ({ ...prev, order: true }));\n    setError(null);\n\n    const orderData = {\n      tenantId: \"chinawok-surco\",\n      items: items.map(item => ({ productId: item.id, quantity: item.quantity, price: item.price })),\n      total: total,\n      customer: {\n        userId: user.username,\n        name: user.attributes?.name || user.username,\n        address: selectedAddress,\n      },\n    };\n\n    try {\n      const response = await chinaWokApi.createOrder(orderData);\n      if (response && response.orderId) {\n        clearCart();\n        setOrderId(response.orderId);\n        setOrderStatus(\"EN_COCINA\");\n      } else {\n        setError(\"Hubo un problema al crear tu pedido.\");\n      }\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"Error al procesar el pedido.\");\n    } finally {\n      setLoading(prev => ({ ...prev, order: false }));\n    }\n  };\n\n  // --- RENDERIZADO CONDICIONAL ---\n\n  if (items.length === 0 && !orderId) {\n    return (\n      <div className=\"text-center\">\n        <ShoppingCart className=\"mx-auto h-16 w-16 text-gray-400 mb-4\" />\n        <p className=\"text-lg text-gray-600 mb-4\">Tu carrito está vacío</p>\n        <Button asChild className=\"bg-cw-green hover:bg-green-700\">\n          <Link href=\"/\">Volver al menú</Link>\n        </Button>\n      </div>\n    );\n  }\n\n  if (orderId) {\n    return (\n      <Card className=\"max-w-2xl mx-auto\">\n        <CardHeader>\n          <CardTitle className=\"flex flex-col items-center gap-2\">\n            <PackageCheck className=\"h-10 w-10 text-cw-green\" />\n            ¡Gracias por tu pedido!\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4 text-center\">\n          <p>ID de tu pedido: <span className=\"font-mono bg-gray-100 p-1 rounded\">{orderId}</span></p>\n          <div className=\"flex items-center justify-center gap-2 text-xl font-bold text-cw-green\">\n            <Loader2 className=\"h-5 w-5 animate-spin\" />\n            <span>{orderStatus?.replace(\"_\", \" \") || \"CONSULTANDO...\"}</span>\n          </div>\n          {orderStatus === \"ENTREGADO\" && <p className=\"mt-4 text-green-600 font-bold\">¡Tu pedido ha sido entregado!</p>}\n          <Button asChild className=\"mt-6 bg-cw-green hover:bg-green-700\">\n            <Link href=\"/\">Hacer otro pedido</Link>\n          </Button>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <div className=\"grid gap-8 md:grid-cols-3\">\n      {/* Columna principal: Direcciones y Usuario */}\n      <div className=\"md:col-span-2 space-y-6\">\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex justify-between items-center\">\n              <div className=\"flex items-center gap-2\"><User className=\"h-5 w-5\" /> Usuario</div>\n              <Button variant=\"ghost\" size=\"sm\" onClick={signOut}><LogOut className=\"h-4 w-4 mr-2\" />Cerrar sesión</Button>\n            </CardTitle>\n            <p className=\"text-sm text-gray-600 pt-1\">Conectado como: {user.attributes?.email || user.username}</p>\n          </CardHeader>\n        </Card>\n\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\"><MapPin className=\"h-5 w-5\" /> Dirección de Entrega</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {loading.profile ? <Loader2 className=\"h-6 w-6 animate-spin\" /> : (\n              <div className=\"space-y-4\">\n                {addresses.length > 0 && (\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">Seleccionar dirección</label>\n                    <select\n                      value={selectedAddress}\n                      onChange={(e) => setSelectedAddress(e.target.value)}\n                      className=\"w-full px-4 py-2 border border-gray-300 rounded-lg\"\n                    >\n                      {addresses\n                        .filter((addr) => addr && addr.name && addr.address)\n                        .map((addr) => (\n                          <option key={`${addr.name}-${addr.address}`} value={addr.address}>\n                            {addr.name} - {addr.address}\n                          </option>\n                        ))}\n                    </select>\n                  </div>\n                )}\n                <Button variant=\"outline\" size=\"sm\" onClick={() => setShowNewAddressForm(!showNewAddressForm)}>\n                  <PlusCircle className=\"h-4 w-4 mr-2\" />\n                  {showNewAddressForm ? \"Cancelar\" : \"Añadir nueva dirección\"}\n                </Button>\n                {showNewAddressForm && (\n                  <form onSubmit={handleSaveAddress} className=\"space-y-4 pt-4 border-t\">\n                    <input type=\"text\" placeholder=\"Nombre (ej. Casa)\" value={newAddress.name} onChange={(e) => setNewAddress(p => ({ ...p, name: e.target.value }))} className=\"w-full input\" required />\n                    <input type=\"text\" placeholder=\"Dirección completa\" value={newAddress.address} onChange={(e) => setNewAddress(p => ({ ...p, address: e.target.value }))} className=\"w-full input\" required />\n                    <Button type=\"submit\" disabled={loading.address} className=\"w-full\">\n                      {loading.address && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n                      Guardar Dirección\n                    </Button>\n                  </form>\n                )}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Columna lateral: Resumen de Pedido */}\n      <div className=\"md:col-span-1\">\n        <Card className=\"sticky top-24\">\n          <CardHeader><CardTitle>Resumen de Pedido</CardTitle></CardHeader>\n          <CardContent className=\"space-y-4\">\n            {/* ... (código del resumen de pedido existente) ... */}\n            <div className=\"pt-4 border-t\">\n              <Button onClick={handleCreateOrder} disabled={loading.order || !selectedAddress} className=\"w-full bg-cw-green hover:bg-green-700 text-white text-lg h-12\">\n                {loading.order ? (<><Loader2 className=\"mr-2 h-5 w-5 animate-spin\" />Creando pedido...</>) : (\"Confirmar Pedido\")}\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n\n/**\n * Componente contenedor que envuelve el flujo de checkout con el Authenticator de Amplify.\n */\nexport default function CheckoutPage() {\n  return (\n    <main className=\"container mx-auto px-4 py-8\">\n      <h1 className=\"text-3xl font-bold text-gray-900 mb-8\">Finalizar Compra</h1>\n      <Authenticator>\n        <CheckoutFlow />\n      </Authenticator>\n    </main>\n  );\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA,uOAA2D,sCAAsC;AACjG;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AACA;AAAA;AAlBA;;;;;;;;;;;AA2BA;;;CAGC,GACD,SAAS;IACP,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,GAAG,IAAA,4SAAgB,EAAC,CAAC,UAAY;YAAC,QAAQ,IAAI;SAAC;IACtE,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,SAAS,EAAE,GAAG,IAAA,6IAAO;IAE3C,yBAAyB;IACzB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;QAAE,SAAS;QAAM,OAAO;QAAO,SAAS;IAAM;IACrF,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAgB;IAElD,yCAAyC;IACzC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAY,EAAE;IACxD,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,iNAAQ,EAAS;IAC/D,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,IAAA,iNAAQ,EAAC;IAC7D,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC;QAAE,MAAM;QAAI,SAAS;IAAG;IAErE,yCAAyC;IACzC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAgB;IACtD,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,iNAAQ,EAAqB;IAEnE,kBAAkB;IAElB,6CAA6C;IAC7C,IAAA,kNAAS,EAAC;QACR,IAAI,MAAM,UAAU;YAClB;QACF;IACF,GAAG;QAAC;KAAK;IAET,mFAAmF;IACnF,IAAA,kNAAS,EAAC;QACR,IAAI,CAAC,SAAS;QACd,MAAM,aAAa,YAAY;YAC7B,IAAI;gBACF,MAAM,YAAY,MAAM,IAAA,iJAAS;gBACjC,MAAM,eAAe,UAAU,IAAI,CAAC,CAAC,IAAM,EAAE,OAAO,KAAK;gBACzD,IAAI,cAAc;oBAChB,eAAe,aAAa,MAAM;oBAClC,IAAI;wBAAC;wBAAa;qBAAY,CAAC,QAAQ,CAAC,aAAa,MAAM,GAAG;wBAC5D,cAAc;oBAChB;gBACF;YACF,EAAE,OAAO,KAAK;gBACZ,QAAQ,KAAK,CAAC,6BAA6B;YAC7C;QACF,GAAG;QACH,OAAO,IAAM,cAAc;IAC7B,GAAG;QAAC;KAAQ;IAEZ,+BAA+B;IAE/B,MAAM,eAAe;QACnB,IAAI,CAAC,MAAM,UAAU;QACrB,WAAW,CAAA,OAAQ,CAAC;gBAAE,GAAG,IAAI;gBAAE,SAAS;YAAK,CAAC;QAC9C,IAAI;YACF,MAAM,UAAU,MAAM,gIAAsB,CAAC,KAAK,QAAQ;YAE1D,kEAAkE;YAClE,MAAM,mBAAmB,QAAQ,SAAS,IAAI,EAAE;YAChD,MAAM,qBAAqB,MAAM,OAAO,CAAC,oBACrC,iBAAiB,GAAG,CAAC,CAAC,UAAoB,CAAC;oBACzC,MAAM;oBACN,SAAS;gBACX,CAAC,KACD,EAAE;YAEN,aAAa;YAEb,oEAAoE;YACpE,IAAI,mBAAmB,MAAM,GAAG,GAAG;gBACjC,mBAAmB,kBAAkB,CAAC,EAAE,CAAC,OAAO;YAClD;QAEF,EAAE,OAAO,KAAK;YACZ,QAAQ,IAAI,CAAC,iEAAiE;YAC9E,aAAa,EAAE,GAAG,0DAA0D;QAC9E,SAAU;YACR,WAAW,CAAA,OAAQ,CAAC;oBAAE,GAAG,IAAI;oBAAE,SAAS;gBAAM,CAAC;QACjD;IACF;IAEA,MAAM,oBAAoB,OAAO;QAC/B,EAAE,cAAc;QAChB,IAAI,CAAC,MAAM,YAAY,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,OAAO,EAAE;YAC9D,SAAS;YACT;QACF;QACA,WAAW,CAAA,OAAQ,CAAC;gBAAE,GAAG,IAAI;gBAAE,SAAS;YAAK,CAAC;QAC9C,SAAS;QACT,IAAI;YACF,MAAM,iIAAuB,CAAC,KAAK,QAAQ,EAAE,WAAW,OAAO,EAAE,WAAW,IAAI;YAChF,cAAc;gBAAE,MAAM;gBAAI,SAAS;YAAG;YACtC,sBAAsB;YACtB,MAAM,gBAAgB,uBAAuB;QAC/C,EAAE,OAAO,KAAK;YACZ,SAAS,eAAe,QAAQ,IAAI,OAAO,GAAG;QAChD,SAAU;YACR,WAAW,CAAA,OAAQ,CAAC;oBAAE,GAAG,IAAI;oBAAE,SAAS;gBAAM,CAAC;QACjD;IACF;IAEA,MAAM,oBAAoB;QACxB,IAAI,CAAC,MAAM,YAAY,CAAC,iBAAiB;YACvC,SAAS;YACT;QACF;QACA,WAAW,CAAA,OAAQ,CAAC;gBAAE,GAAG,IAAI;gBAAE,OAAO;YAAK,CAAC;QAC5C,SAAS;QAET,MAAM,YAAY;YAChB,UAAU;YACV,OAAO,MAAM,GAAG,CAAC,CAAA,OAAQ,CAAC;oBAAE,WAAW,KAAK,EAAE;oBAAE,UAAU,KAAK,QAAQ;oBAAE,OAAO,KAAK,KAAK;gBAAC,CAAC;YAC5F,OAAO;YACP,UAAU;gBACR,QAAQ,KAAK,QAAQ;gBACrB,MAAM,KAAK,UAAU,EAAE,QAAQ,KAAK,QAAQ;gBAC5C,SAAS;YACX;QACF;QAEA,IAAI;YACF,MAAM,WAAW,MAAM,iIAAuB,CAAC;YAC/C,IAAI,YAAY,SAAS,OAAO,EAAE;gBAChC;gBACA,WAAW,SAAS,OAAO;gBAC3B,eAAe;YACjB,OAAO;gBACL,SAAS;YACX;QACF,EAAE,OAAO,KAAK;YACZ,SAAS,eAAe,QAAQ,IAAI,OAAO,GAAG;QAChD,SAAU;YACR,WAAW,CAAA,OAAQ,CAAC;oBAAE,GAAG,IAAI;oBAAE,OAAO;gBAAM,CAAC;QAC/C;IACF;IAEA,kCAAkC;IAElC,IAAI,MAAM,MAAM,KAAK,KAAK,CAAC,SAAS;QAClC,qBACE,8OAAC;YAAI,WAAU;;8BACb,8OAAC,sOAAY;oBAAC,WAAU;;;;;;8BACxB,8OAAC;oBAAE,WAAU;8BAA6B;;;;;;8BAC1C,8OAAC,qIAAM;oBAAC,OAAO;oBAAC,WAAU;8BACxB,cAAA,8OAAC,uKAAI;wBAAC,MAAK;kCAAI;;;;;;;;;;;;;;;;;IAIvB;IAEA,IAAI,SAAS;QACX,qBACE,8OAAC,iIAAI;YAAC,WAAU;;8BACd,8OAAC,uIAAU;8BACT,cAAA,8OAAC,sIAAS;wBAAC,WAAU;;0CACnB,8OAAC,sOAAY;gCAAC,WAAU;;;;;;4BAA4B;;;;;;;;;;;;8BAIxD,8OAAC,wIAAW;oBAAC,WAAU;;sCACrB,8OAAC;;gCAAE;8CAAiB,8OAAC;oCAAK,WAAU;8CAAqC;;;;;;;;;;;;sCACzE,8OAAC;4BAAI,WAAU;;8CACb,8OAAC,4NAAO;oCAAC,WAAU;;;;;;8CACnB,8OAAC;8CAAM,aAAa,QAAQ,KAAK,QAAQ;;;;;;;;;;;;wBAE1C,gBAAgB,6BAAe,8OAAC;4BAAE,WAAU;sCAAgC;;;;;;sCAC7E,8OAAC,qIAAM;4BAAC,OAAO;4BAAC,WAAU;sCACxB,cAAA,8OAAC,uKAAI;gCAAC,MAAK;0CAAI;;;;;;;;;;;;;;;;;;;;;;;IAKzB;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BAEb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC,iIAAI;kCACH,cAAA,8OAAC,uIAAU;;8CACT,8OAAC,sIAAS;oCAAC,WAAU;;sDACnB,8OAAC;4CAAI,WAAU;;8DAA0B,8OAAC,0MAAI;oDAAC,WAAU;;;;;;gDAAY;;;;;;;sDACrE,8OAAC,qIAAM;4CAAC,SAAQ;4CAAQ,MAAK;4CAAK,SAAS;;8DAAS,8OAAC,oNAAM;oDAAC,WAAU;;;;;;gDAAiB;;;;;;;;;;;;;8CAEzF,8OAAC;oCAAE,WAAU;;wCAA6B;wCAAiB,KAAK,UAAU,EAAE,SAAS,KAAK,QAAQ;;;;;;;;;;;;;;;;;;kCAItG,8OAAC,iIAAI;;0CACH,8OAAC,uIAAU;0CACT,cAAA,8OAAC,sIAAS;oCAAC,WAAU;;sDAA0B,8OAAC,oNAAM;4CAAC,WAAU;;;;;;wCAAY;;;;;;;;;;;;0CAE/E,8OAAC,wIAAW;0CACT,QAAQ,OAAO,iBAAG,8OAAC,4NAAO;oCAAC,WAAU;;;;;yDACpC,8OAAC;oCAAI,WAAU;;wCACZ,UAAU,MAAM,GAAG,mBAClB,8OAAC;;8DACC,8OAAC;oDAAM,WAAU;8DAA+C;;;;;;8DAChE,8OAAC;oDACC,OAAO;oDACP,UAAU,CAAC,IAAM,mBAAmB,EAAE,MAAM,CAAC,KAAK;oDAClD,WAAU;8DAET,UACE,MAAM,CAAC,CAAC,OAAS,QAAQ,KAAK,IAAI,IAAI,KAAK,OAAO,EAClD,GAAG,CAAC,CAAC,qBACJ,8OAAC;4DAA4C,OAAO,KAAK,OAAO;;gEAC7D,KAAK,IAAI;gEAAC;gEAAI,KAAK,OAAO;;2DADhB,GAAG,KAAK,IAAI,CAAC,CAAC,EAAE,KAAK,OAAO,EAAE;;;;;;;;;;;;;;;;sDAOrD,8OAAC,qIAAM;4CAAC,SAAQ;4CAAU,MAAK;4CAAK,SAAS,IAAM,sBAAsB,CAAC;;8DACxE,8OAAC,gOAAU;oDAAC,WAAU;;;;;;gDACrB,qBAAqB,aAAa;;;;;;;wCAEpC,oCACC,8OAAC;4CAAK,UAAU;4CAAmB,WAAU;;8DAC3C,8OAAC;oDAAM,MAAK;oDAAO,aAAY;oDAAoB,OAAO,WAAW,IAAI;oDAAE,UAAU,CAAC,IAAM,cAAc,CAAA,IAAK,CAAC;gEAAE,GAAG,CAAC;gEAAE,MAAM,EAAE,MAAM,CAAC,KAAK;4DAAC,CAAC;oDAAI,WAAU;oDAAe,QAAQ;;;;;;8DACnL,8OAAC;oDAAM,MAAK;oDAAO,aAAY;oDAAqB,OAAO,WAAW,OAAO;oDAAE,UAAU,CAAC,IAAM,cAAc,CAAA,IAAK,CAAC;gEAAE,GAAG,CAAC;gEAAE,SAAS,EAAE,MAAM,CAAC,KAAK;4DAAC,CAAC;oDAAI,WAAU;oDAAe,QAAQ;;;;;;8DAC1L,8OAAC,qIAAM;oDAAC,MAAK;oDAAS,UAAU,QAAQ,OAAO;oDAAE,WAAU;;wDACxD,QAAQ,OAAO,kBAAI,8OAAC,4NAAO;4DAAC,WAAU;;;;;;wDAA+B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAYtF,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC,iIAAI;oBAAC,WAAU;;sCACd,8OAAC,uIAAU;sCAAC,cAAA,8OAAC,sIAAS;0CAAC;;;;;;;;;;;sCACvB,8OAAC,wIAAW;4BAAC,WAAU;sCAErB,cAAA,8OAAC;gCAAI,WAAU;0CACb,cAAA,8OAAC,qIAAM;oCAAC,SAAS;oCAAmB,UAAU,QAAQ,KAAK,IAAI,CAAC;oCAAiB,WAAU;8CACxF,QAAQ,KAAK,iBAAI;;0DAAE,8OAAC,4NAAO;gDAAC,WAAU;;;;;;4CAA8B;;uDAAyB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQ9G;AAKe,SAAS;IACtB,qBACE,8OAAC;QAAK,WAAU;;0BACd,8OAAC;gBAAG,WAAU;0BAAwC;;;;;;0BACtD,8OAAC,gOAAa;0BACZ,cAAA,8OAAC;;;;;;;;;;;;;;;;AAIT"}}]
}